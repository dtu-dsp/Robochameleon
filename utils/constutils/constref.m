%> @file constref.m
%> @brief Constellation reference
%>
%>
%>   This function returns regular reference constellations that can be
%>   easily parameterized.
%>
%>  __Usage__
%>
%>@code
%>   [c, P] = constref(type, M, ROT)
%>@endcode
%>
%>@param type constellation type {'ASK','QAM','PSK','DSQ','B','C','CIRCA',\n
%> 'CIRCB','CIRCULAR','COMPACT','CROSS','DODECA','DOUBLESIMPLEX','DOUBLEQPSK',\n
%> 'ENNEA','FIVECIRCLE','HEPTA','HEX','HONEYCOMB','MODEM','MULTIPSK','OCTA',\n
%> 'PENTA','RECTANGLE','STAR','SQUARE','SIXCIRCLE','T','TA','TB','TRI',\n
%> 'V29MODEM','VORONOI','DPASK'}\n
%> type can also be {'OOK','PAM','QPSK','16-QAM'} for fast reference, and
%> is not case-sensitive.
%>
%> @param M constellation order (number of points/levels).
%>           M must be an integer such that:\n
%>           - for 'ASK',           M=any \n
%>           - for 'QAM',           M=4/8/16/32/60/64/256/1024/4096...\n
%>           - for 'PSK',           M=any \n
%>           - for 'DSQ',           M=8/32/128/512 \n
%>           - for 'B',             M=128
%>           - for 'C',             M=8/16/32/64/128/256
%>           - for 'CIRCA',         M=32/64
%>           - for 'CIRCB',         M=32/64
%>           - for 'CIRCULAR',      M=64
%>           - for 'COMPACT',       M=16
%>           - for 'CROSS',         M=16/32/64/128/512
%>           - for 'DODECA',        M=16
%>           - for 'DOUBLESIMPLEX', M=4
%>           - for 'DOUBLEQPSK',    M=8
%>           - for 'ENNEA',         M=16
%>           - for 'FIVECIRCLE',    M=128
%>           - for 'HEPTA',         M=8
%>           - for 'HEX',           M=16
%>           - for 'HONEYCOMB',     M=16/32/64
%>           - for 'MODEM',         M=8/64
%>           - for 'MULTIPSK',      M=16/32
%>           - for 'OCTA',          M=16
%>           - for 'PENTA',         M=16
%>           - for 'RECTANGLE',     M=8
%>           - for 'STAR',          M=8
%>           - for 'SQUARE',        M=8
%>           - for 'SIXCIRCLE',     M=128
%>           - for 'T',             M=16
%>           - for 'TA',            M=32
%>           - for 'TB',            M=32
%>           - for 'TRI',           M=4/16/32/64/128
%>           - for 'V29MODEM',      M=8/16
%>           - for 'VORONOI',       M=64
%>           - for 'DPASK'          M=4/8/16/64/256/1024...
%>           - for 'OOK'            M=2
%>           - for 'QPSK'           M=4
%>           - for '16-QAM',        M=16
%>
%> @param ROT constellation rotation in degrees
%>
%> @retval  c - complex constellation
%> @retval P average constellation energy (scaling factor)
%>           use c/sqrt(P) for normalization
%>
%>  __Conventions__
%>
%>  'QAM':
%>  Clusters for QAM are returned in the following order:
%>@verbatim
%>         Q(j)
%>    1  5 |  9 13
%>    2  6 | 10 14
%>   ------+------- I
%>    3  7 | 11 15
%>    4  8 | 12 16
%>@endverbatim
%>
%>
%> 'QAM' (M=8):
%> 8-QAM returns a constellation from a subset of 16QAM.  8-Star returns a
%> circular QAM constellation with 8 points, which is more commonly used in
%> optics as 8QAM.
%>@verbatim
%>      Q(j)
%>   1   |   7
%>     3 | 5
%>   ----+--- I
%>     4 | 6
%>   2   |   8
%>@endverbatim
%>
%> 'PSK':
%> Clusters for PSK are returned in the following order (first point always has phase of 0):
%>
%>@verbatim
%>        Q(j)
%>         3
%>      4  |  2
%>   -5----+----1- I
%>      6  |  8
%>         7
%>@endverbatim
%>
%> 'CROSS' (M = 16/32/128/512):
%>@verbatim
%>                                                                         M=128
%>                                                                          Q(j)
%>                                                           017 029 041 053|065 077 089 101
%>         M=16                     M=32                     018 030 042 054|066 078 090 102
%>         Q(j)                     Q(j)             001 009 019 031 043 055|067 079 091 103 113 121
%>          |                   05 11|17 23          002 010 020 032 044 056|068 080 092 104 114 122
%>       03 07 11            01 06 12|18 24 29       003 011 021 033 045 057|069 081 093 105 115 123
%>    01 04 08 12 15         02 07 13|19 25 30       004 012 022 034 046 058|070 082 094 106 116 124
%>   -------+---------I     ---------+---------I   -------------------------+------------------------I
%>    02 05 09 13 16         03 08 14|20 26 31       005 013 023 035 047 059|071 083 095 107 117 125
%>       06 10 14            04 09 15|21 27 32       006 014 024 036 048 060|072 084 096 108 118 126
%>          |                   10 16|22 28          007 015 025 037 049 061|073 085 097 109 119 127
%>                                                   008 016 026 038 050 062|074 086 098 110 120 128
%>                                                            027 039 051 063|075 087 099 111
%>                                                            028 040 052 064|076 088 100 112
%>
%>
%>                                                M=512
%>                                                Q(j)
%>                  065 089 113 137 161 185 209 233|257 281 305 329 353 377 401 425
%>                  066 090 114 138 162 186 210 234|258 282 306 330 354 378 402 426
%>                  067 091 115 139 163 187 211 235|259 283 307 331 355 379 403 427
%>                  068 092 116 140 164 188 212 236|260 284 308 332 356 380 404 428
%>  001 017 033 049 069 093 117 141 165 189 213 237|261 285 309 333 357 381 405 429 449 465 481 497
%>  002 018 034 050 070 094 118 142 166 190 214 238|262 286 310 334 358 382 406 430 450 466 482 498
%>  003 019 035 051 071 095 119 143 167 191 215 239|263 287 311 335 359 383 407 431 451 467 483 499
%>  004 020 036 052 072 096 120 144 168 192 216 240|264 288 312 336 360 384 408 432 452 468 484 500
%>  005 021 037 053 073 097 121 145 169 193 217 241|265 289 313 337 361 385 409 433 453 469 485 501
%>  006 022 038 054 074 098 122 146 170 194 218 242|266 290 314 338 362 386 410 434 454 470 486 502
%>  007 023 039 055 075 099 123 147 171 195 219 243|267 291 315 339 363 387 411 435 455 471 487 503
%>  008 024 040 056 076 100 124 148 172 196 220 244|268 292 316 340 364 388 412 436 456 472 488 504
%> ------------------------------------------------+------------------------------------------------I
%>  009 025 041 057 077 101 125 149 173 197 221 245|269 293 317 341 365 389 413 437 457 473 489 505
%>  010 026 042 058 078 102 126 150 174 198 222 246|270 294 318 342 366 390 414 438 458 474 490 506
%>  011 027 043 059 079 103 127 151 175 199 223 247|271 295 319 343 367 391 415 439 459 475 491 507
%>  012 028 044 060 080 104 128 152 176 200 224 248|272 296 320 344 368 392 416 440 460 476 492 508
%>  013 029 045 061 081 105 129 153 177 201 225 249|273 297 321 345 369 393 417 441 461 477 493 509
%>  014 030 046 062 082 106 130 154 178 202 226 250|274 298 322 346 340 394 418 442 462 478 494 510
%>  015 031 047 063 083 107 131 155 179 203 227 251|275 299 323 347 341 395 419 443 463 479 495 511
%>  016 032 048 064 084 108 132 156 180 204 228 252|276 300 324 348 342 396 420 444 464 480 496 512
%>                  085 109 133 157 181 205 229 253|277 301 325 349 343 397 421 445
%>                  086 110 134 158 182 206 230 254|278 302 326 350 344 398 422 446
%>                  087 111 135 159 183 207 231 255|279 303 327 351 345 399 423 447
%>                  088 112 136 160 184 208 232 256|280 304 328 352 346 400 424 448
%>@endverbatim
%>
%> 'DODECA' (M = 16):
%>@verbatim
%>        Q(j)
%>        8
%>    04  |  12
%>  02  06|10  14
%> 01-----+-----16 I
%>  03  07|11  15
%>    05  |  13
%>        9
%>@endverbatim
%>
%> 'DOUBLESIMPLEX' (M = 4):
%>@verbatim
%>        Q(j)
%>         2
%>         |
%>   ----1-+-4---- I
%>         |
%>         3
%>@endverbatim
%>
%> 'DOUBLEQPSK' (M = 8)
%>@verbatim
%>      Q(j)
%>   1   |   7
%>     3 | 5
%>   ----+--- I
%>     4 | 6
%>   2   |   8
%>@endverbatim
%>
%> 'DSQ' (M = 8/32/128/512)
%>@verbatim
%>                          Q(j)
%>                      05  13|  21  29
%>      Q(j)          01  09  |17  25
%>      3 |    7        06  14|  22  30
%>   1    | 5         02  10  |18  26
%>   -----+----- I    --------+--------- I
%>      4 |    8        07  15|  23  31
%>   2    | 6         03  11  |19  27
%>                      08  16|  24  32
%>                    04  12  |20  28
%>@endverbatim
%>
%> 'ENNEA' (M = 16)
%>@verbatim
%>      Q(j)
%>      06|11
%>  03    |    14
%> 01   07|10    16
%>  ------+------- I
%>  02 05 08 12 15
%>    04  |   13
%>        09
%>@endverbatim
%>
%> 'HEPTA' (M = 8):
%>@verbatim
%>        Q(j)
%>        3|
%>     4   |  2
%>   ------8----1- I
%>     5   |  7
%>        6|
%>@endverbatim
%>
%> 'HONEYCOMB' (M = 16):
%>@verbatim
%>           Q(j)
%>          06|09
%>     02 04  |  12 14
%>   01-----07+10-----16- I
%>     03 05  |  13 15
%>          08|11
%>@endverbatim
%>
%> 'MODEM' (M = 8):
%>@verbatim
%>        Q(j)
%>         |
%>     1   4   7
%>   ----3-+-6---- I
%>     2   5   8
%>         |
%>@endverbatim
%>
%> 'MULTIPSK' (M = 16):
%>@verbatim
%>        Q(j)
%>      11 | 10
%>        3|2   9
%>   12 4  |  1
%>   ------+------ I
%>   13 5  |  8
%>        6|7   16
%>      14 | 15
%>@endverbatim
%>
%> 'OCTA' (M = 16):
%>@verbatim
%>        Q(j)
%>         11
%>    12  3|2  10
%>      4  |  1
%>   13----+-----9- I
%>      5  |  8
%>    14  6|7  16
%>         15
%>@endverbatim
%>
%> 'PENTA' (M = 16):
%>@verbatim
%>        Q(j)
%>     10  9  8
%>         |
%>  11    3| 2   7
%>   ---4--1------- I
%>  12    5| 6   16
%>         |
%>     13  14 15
%>@endverbatim
%>
%> 'RECTANGLE' (M = 8):
%>@verbatim
%>        Q(j)
%>         |
%>     1  3|5  7
%>   ------+----- I
%>     2  4|6  8
%>         |
%>@endverbatim
%>
%> 'SQUARE' (M = 8):
%>@verbatim
%>        Q(j)
%>     1    4    6
%>          |
%>   --2----+----7-- I
%>          |
%>     3    5    8
%>@endverbatim
%>
%> 'STAR' (M = 8):
%>@verbatim
%>        Q(j)
%>    1    |    7
%>         4
%>   ---3--+--6--- I
%>         5
%>    2    |    8
%>@endverbatim
%>
%> 'TRI' (M = 4/16):
%>@verbatim
%>  M=4    Q(j)
%>          2
%>          |
%>   -------3------- I
%>       1  |  4
%>          |
%>
%> M=16     Q(j)
%>       04  8  12
%>     02  06|10  14
%>   --------+---------I
%>   01  05  9  13  16
%>     03  07|11  15
%>@endverbatim
%>
%> 'DPASK':
%> Clusters for DP-ASK are returned in the following order:
%>
%>@verbatim
%>   Py
%>   | 4  8 12 16
%>   | 3  7 11 15
%>   | 2  6 10 14
%>   | 1  5  9 13
%>   +------------ Px
%>@endverbatim
%>
%> @see constmap.m
%>
%> @author Robert Borkowski 15.8.2014
%> @author Júlio César M. Diniz 11.03.2016
%> @version v4.0
function [c,P] = constref(type,M,varargin)

switch lower(type)
    case {'ask' 'pam'}
        if mod(M,1) == 0
            c = 0:M-1;
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
    case {'qam'}
        if ~rem(M,sqrt(M)) % square QAM constellation
            X = 1-sqrt(M):2:sqrt(M)-1;
            [I,Q] = meshgrid(X);
            c = I+1j*Q;
            c = flipud(c);
        elseif M == 2
            c = constref('PSK', 2, 0);
        elseif M==8
            c = constref('QAM',16);
            mask = [ 1 0 0 1
                0 1 1 0
                0 1 1 0
                1 0 0 1 ];
            c = c(logical(mask(:)));
        elseif M==12
            c = constref('QAM',16);
            mask = [ 0 1 1 0
                1 1 1 1
                1 1 1 1
                0 1 1 0 ];
            c = c(logical(mask(:)));
        elseif M==32
            c = constref('QAM',36);
            mask = [ 0 1 1 1 1 0
                1 1 1 1 1 1
                1 1 1 1 1 1
                1 1 1 1 1 1
                1 1 1 1 1 1
                0 1 1 1 1 0 ];
            c = c(logical(mask(:)));
        elseif M==60
            m = 64; sqrtm = 8;
            c = constref('QAM',m);
            mask = ones(sqrtm,sqrtm);
            mask([1 sqrtm m-[1 sqrtm]+1]) = 0;
            c = c(logical(mask(:)));
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
        
        % Dual polarization ASK in Px-Py plane (intensity X vs. intensity Y)
        % Redefine real(I)->Px, imag(Q)->Py.
    case 'dpask'
        if ~rem(M,sqrt(M)) % square constellation
            X = 0:sqrt(M)-1;
            [Px,Py] = meshgrid(X);
            c = Px+1j*Py;
        elseif M==8
            c = constref('DPASK',16);
            mask = [ 0 1 0 1
                1 0 1 0
                0 1 0 1
                1 0 1 0 ];
            mask = flipud(mask);
            c = c(logical(mask(:)));
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
    case 'ook'
        if M == 2
            c = constref('ASK',2);
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
    case 'qpsk'
        if M == 4
            c = constref('QAM',4);
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
    case '16-qam'
        if M == 16
            c = constref('QAM',16);
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
        
    case 'b'
        if M == 128
            c = [-13-1j -13+1j -11-5j -11-3j -11-1j -11+1j -11+3j -11+5j -9-7j -9-5j -9-3j -9-1j -9+1j -9+3j -9+5j -9+7j -7-9j -7-7j -7-5j -7-3j -7-1j -7+1j -7+3j -7+5j -7+7j -7+9j -5-11j -5-9j -5-7j -5-5j -5-3j -5-1j -5+1j -5+3j -5+5j -5+7j -5+9j -5+11j -3-11j -3-9j -3-7j -3-5j -3-3j -3-1j -3+1j -3+3j -3+5j -3+7j -3+9j -3+11j -1-13j -1-11j -1-9j -1-7j -1-5j -1-3j -1-1j -1+1j -1+3j -1+5j -1+7j -1+9j -1+11j -1+13j 1-13j 1-11j 1-9j 1-7j 1-5j 1-3j 1-1j 1+1j 1+3j 1+5j 1+7j 1+9j 1+11j 1+13j 3-11j 3-9j 3-7j 3-5j 3-3j 3-1j 3+1j 3+3j 3+5j 3+7j 3+9j 3+11j 5-11j 5-9j 5-7j 5-5j 5-3j 5-1j 5+1j 5+3j 5+5j 5+7j 5+9j 5+11j 7-9j 7-7j 7-5j 7-3j 7-1j 7+1j 7+3j 7+5j 7+7j 7+9j 9-7j 9-5j 9-3j 9-1j 9+1j 9+3j 9+5j 9+7j 11-5j 11-3j 11-1j 11+1j 11+3j 11+5j 13-1j 13+1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'c'
        if M == 8;
            c = [-2-0.4330127018922193j -1-2.1650635094610964j -1+1.2990381056766578j 0-0.4330127018922193j 0+3.031088913245535j 1-2.1650635094610964j 1+1.299038105676658j 2-0.4330127018922193j];
        elseif M == 16
            c = [-7-3.4641016151377544j -7+3.4641016151377544j -5+0j -3-3.4641016151377544j -3+3.4641016151377544j -1-6.928203230275509j -1+0j -1+6.928203230275509j 1-3.4641016151377544j 1+3.4641016151377544j 3-6.928203230275509j 3+0j 3+6.928203230275509j 5-3.4641016151377544j 5+3.4641016151377544j 7+0j];
        elseif M == 32
            c = [-83-27.712812921102035j -83+27.712812921102035j -67-55.42562584220407j -67+0j -67+55.42562584220407j -51-27.712812921102035j -51+27.712812921102035j -35-55.42562584220407j -35+0j -35+55.42562584220407j -19-83.13843876330611j -19-27.712812921102035j -19+27.712812921102035j -19+83.13843876330611j -3-55.42562584220407j -3+0j -3+55.42562584220407j 13-83.13843876330611j 13-27.712812921102035j 13+27.712812921102035j 13+83.13843876330611j 29-55.42562584220407j 29+0j 29+55.42562584220407j 45-27.712812921102035j 45+27.712812921102035j 61-55.42562584220407j 61+0j 61+55.42562584220407j 77-27.712812921102035j 77+27.712812921102035j 93+0j]';
        elseif M == 64
            c = [-8-1.7320508075688772j -8+1.7320508075688772j -7-3.4641016151377544j -7+0j -7+3.4641016151377544j -6-5.196152422706632j -6-1.7320508075688772j -6+1.7320508075688772j -6+5.196152422706632j -5-3.4641016151377544j -5+0j -5+3.4641016151377544j -4-5.196152422706632j -4-1.7320508075688772j -4+1.7320508075688772j -4+5.196152422706632j -3-6.928203230275509j -3-3.4641016151377544j -3+0j -3+3.4641016151377544j -3+6.928203230275509j -2-5.196152422706632j -2-1.7320508075688772j -2+1.7320508075688772j -2+5.196152422706632j -1-6.928203230275509j -1-3.4641016151377544j -1+0j -1+3.4641016151377544j -1+6.928203230275509j 0-5.196152422706632j 0-1.7320508075688772j 0+1.7320508075688772j 0+5.196152422706632j 1-6.928203230275509j 1-3.4641016151377544j 1+0j 1+3.4641016151377544j 1+6.928203230275509j 2-5.196152422706632j 2-1.7320508075688772j 2+1.7320508075688772j 2+5.196152422706632j 3-6.928203230275509j 3-3.4641016151377544j 3+0j 3+3.4641016151377544j 3+6.928203230275509j 4-5.196152422706632j 4-1.7320508075688772j 4+1.7320508075688772j 4+5.196152422706632j 5-3.4641016151377544j 5+0j 5+3.4641016151377544j 6-5.196152422706632j 6-1.7320508075688772j 6+1.7320508075688772j 6+5.196152422706632j 7-3.4641016151377544j 7+0j 7+3.4641016151377544j 8-1.7320508075688772j 8+1.7320508075688772j]';
        elseif M == 128
            c = [-11-3.599418084479073j -11-0.13531646934131852j -11+3.3287851457964357j -10-5.33146889204795j -10-1.8673672769101957j -10+1.5967343382275587j -10+5.060835953365314j -9-7.063519699616827j -9-3.599418084479073j -9-0.13531646934131852j -9+3.3287851457964357j -9+6.7928867609341905j -8-5.33146889204795j -8-1.8673672769101957j -8+1.5967343382275587j -8+5.060835953365314j -8+8.524937568503066j -7-7.063519699616827j -7-3.599418084479073j -7-0.13531646934131852j -7+3.3287851457964357j -7+6.7928867609341905j -6-8.795570507185705j -6-5.33146889204795j -6-1.8673672769101957j -6+1.5967343382275587j -6+5.060835953365314j -6+8.524937568503066j -5-10.527621314754583j -5-7.063519699616827j -5-3.599418084479073j -5-0.13531646934131852j -5+3.3287851457964357j -5+6.7928867609341905j -5+10.256988376071945j -4-8.795570507185705j -4-5.33146889204795j -4-1.8673672769101957j -4+1.5967343382275587j -4+5.060835953365314j -4+8.524937568503066j -3-10.527621314754583j -3-7.063519699616827j -3-3.599418084479073j -3-0.13531646934131852j -3+3.3287851457964357j -3+6.7928867609341905j -3+10.256988376071945j -2-8.795570507185705j -2-5.33146889204795j -2-1.8673672769101957j -2+1.5967343382275587j -2+5.060835953365314j -2+8.524937568503066j -1-10.527621314754583j -1-7.063519699616827j -1-3.599418084479073j -1-0.13531646934131852j -1+3.3287851457964357j -1+6.7928867609341905j -1+10.256988376071945j 0-8.795570507185705j 0-5.33146889204795j 0-1.8673672769101957j 0+1.5967343382275587j 0+5.060835953365314j 0+8.524937568503066j 1-10.527621314754583j 1-7.063519699616827j 1-3.599418084479073j 1-0.13531646934131852j 1+3.3287851457964357j 1+6.7928867609341905j 1+10.256988376071945j 2-8.795570507185705j 2-5.33146889204795j 2-1.8673672769101957j 2+1.5967343382275587j 2+5.060835953365314j 2+8.524937568503066j 3-10.527621314754583j 3-7.063519699616827j 3-3.599418084479073j 3-0.13531646934131852j 3+3.3287851457964357j 3+6.7928867609341905j 3+10.256988376071945j 4-8.795570507185705j 4-5.33146889204795j 4-1.8673672769101957j 4+1.5967343382275587j 4+5.060835953365314j 4+8.524937568503066j 5-10.527621314754583j 5-7.063519699616827j 5-3.599418084479073j 5-0.13531646934131852j 5+3.3287851457964357j 5+6.7928867609341905j 5+10.256988376071945j 6-8.795570507185705j 6-5.33146889204795j 6-1.8673672769101957j 6+1.5967343382275587j 6+5.060835953365314j 6+8.524937568503066j 7-7.063519699616827j 7-3.599418084479073j 7-0.13531646934131852j 7+3.3287851457964357j 7+6.7928867609341905j 8-5.33146889204795j 8-1.8673672769101957j 8+1.5967343382275587j 8+5.060835953365314j 8+8.524937568503066j 9-7.063519699616827j 9-3.599418084479073j 9-0.13531646934131852j 9+3.3287851457964357j 9+6.7928867609341905j 10-5.33146889204795j 10-1.8673672769101957j 10+1.5967343382275587j 10+5.060835953365314j 11-3.599418084479073j 11-0.13531646934131852j 11+3.3287851457964357j]';
        elseif M == 256
            c = [-1035-225.16660498395404j -1035-3.4641016151377544j -1035+218.23840175367852j -971-336.0178566683622j -971-114.31535329954589j -971+107.38715006927039j -971+329.0896534380867j -907-446.8691083527703j -907-225.16660498395404j -907-3.4641016151377544j -907+218.23840175367852j -907+439.9409051224948j -843-557.7203600371785j -843-336.0178566683622j -843-114.31535329954589j -843+107.38715006927039j -843+329.0896534380867j -843+550.7921568069029j -779-668.5716117215867j -779-446.8691083527703j -779-225.16660498395404j -779-3.4641016151377544j -779+218.23840175367852j -779+439.9409051224948j -779+661.6434084913111j -715-779.4228634059948j -715-557.7203600371785j -715-336.0178566683622j -715-114.31535329954589j -715+107.38715006927039j -715+329.0896534380867j -715+550.7921568069029j -715+772.4946601757192j -651-668.5716117215867j -651-446.8691083527703j -651-225.16660498395404j -651-3.4641016151377544j -651+218.23840175367852j -651+439.9409051224948j -651+661.6434084913111j -587-779.4228634059948j -587-557.7203600371785j -587-336.0178566683622j -587-114.31535329954589j -587+107.38715006927039j -587+329.0896534380867j -587+550.7921568069029j -587+772.4946601757192j -523-890.2741150904029j -523-668.5716117215867j -523-446.8691083527703j -523-225.16660498395404j -523-3.4641016151377544j -523+218.23840175367852j -523+439.9409051224948j -523+661.6434084913111j -523+883.3459118601273j -459-779.4228634059948j -459-557.7203600371785j -459-336.0178566683622j -459-114.31535329954589j -459+107.38715006927039j -459+329.0896534380867j -459+550.7921568069029j -459+772.4946601757192j -395-890.2741150904029j -395-668.5716117215867j -395-446.8691083527703j -395-225.16660498395404j -395-3.4641016151377544j -395+218.23840175367852j -395+439.9409051224948j -395+661.6434084913111j -395+883.3459118601273j -331-1001.125366774811j -331-779.4228634059948j -331-557.7203600371785j -331-336.0178566683622j -331-114.31535329954589j -331+107.38715006927039j -331+329.0896534380867j -331+550.7921568069029j -331+772.4946601757192j -331+994.1971635445354j -267-890.2741150904029j -267-668.5716117215867j -267-446.8691083527703j -267-225.16660498395404j -267-3.4641016151377544j -267+218.23840175367852j -267+439.9409051224948j -267+661.6434084913111j -267+883.3459118601273j -203-1001.125366774811j -203-779.4228634059948j -203-557.7203600371785j -203-336.0178566683622j -203-114.31535329954589j -203+107.38715006927039j -203+329.0896534380867j -203+550.7921568069029j -203+772.4946601757192j -203+994.1971635445354j -139-890.2741150904029j -139-668.5716117215867j -139-446.8691083527703j -139-225.16660498395404j -139-3.4641016151377544j -139+218.23840175367852j -139+439.9409051224948j -139+661.6434084913111j -139+883.3459118601273j -75-1001.125366774811j -75-779.4228634059948j -75-557.7203600371785j -75-336.0178566683622j -75-114.31535329954589j -75+107.38715006927039j -75+329.0896534380867j -75+550.7921568069029j -75+772.4946601757192j -75+994.1971635445354j -11-890.2741150904029j -11-668.5716117215867j -11-446.8691083527703j -11-225.16660498395404j -11-3.4641016151377544j -11+218.23840175367852j -11+439.9409051224948j -11+661.6434084913111j -11+883.3459118601273j 53-1001.125366774811j 53-779.4228634059948j 53-557.7203600371785j 53-336.0178566683622j 53-114.31535329954589j 53+107.38715006927039j 53+329.0896534380867j 53+550.7921568069029j 53+772.4946601757192j 53+994.1971635445354j 117-890.2741150904029j 117-668.5716117215867j 117-446.8691083527703j 117-225.16660498395404j 117-3.4641016151377544j 117+218.23840175367852j 117+439.9409051224948j 117+661.6434084913111j 117+883.3459118601273j 181-1001.125366774811j 181-779.4228634059948j 181-557.7203600371785j 181-336.0178566683622j 181-114.31535329954589j 181+107.38715006927039j 181+329.0896534380867j 181+550.7921568069029j 181+772.4946601757192j 181+994.1971635445354j 245-890.2741150904029j 245-668.5716117215867j 245-446.8691083527703j 245-225.16660498395404j 245-3.4641016151377544j 245+218.23840175367852j 245+439.9409051224948j 245+661.6434084913111j 245+883.3459118601273j 309-1001.125366774811j 309-779.4228634059948j 309-557.7203600371785j 309-336.0178566683622j 309-114.31535329954589j 309+107.38715006927039j 309+329.0896534380867j 309+550.7921568069029j 309+772.4946601757192j 309+994.1971635445354j 373-890.2741150904029j 373-668.5716117215867j 373-446.8691083527703j 373-225.16660498395404j 373-3.4641016151377544j 373+218.23840175367852j 373+439.9409051224948j 373+661.6434084913111j 373+883.3459118601273j 437-779.4228634059948j 437-557.7203600371785j 437-336.0178566683622j 437-114.31535329954589j 437+107.38715006927039j 437+329.0896534380867j 437+550.7921568069029j 437+772.4946601757192j 501-890.2741150904029j 501-668.5716117215867j 501-446.8691083527703j 501-225.16660498395404j 501-3.4641016151377544j 501+218.23840175367852j 501+439.9409051224948j 501+661.6434084913111j 501+883.3459118601273j 565-779.4228634059948j 565-557.7203600371785j 565-336.0178566683622j 565-114.31535329954589j 565+107.38715006927039j 565+329.0896534380867j 565+550.7921568069029j 565+772.4946601757192j 629-668.5716117215867j 629-446.8691083527703j 629-225.16660498395404j 629-3.4641016151377544j 629+218.23840175367852j 629+439.9409051224948j 629+661.6434084913111j 629+883.3459118601273j 693-779.4228634059948j 693-557.7203600371785j 693-336.0178566683622j 693-114.31535329954589j 693+107.38715006927039j 693+329.0896534380867j 693+550.7921568069029j 693+772.4946601757192j 757-668.5716117215867j 757-446.8691083527703j 757-225.16660498395404j 757-3.4641016151377544j 757+218.23840175367852j 757+439.9409051224948j 757+661.6434084913111j 821-557.7203600371785j 821-336.0178566683622j 821-114.31535329954589j 821+107.38715006927039j 821+329.0896534380867j 821+550.7921568069029j 885-446.8691083527703j 885-225.16660498395404j 885-3.4641016151377544j 885+218.23840175367852j 885+439.9409051224948j 949-336.0178566683622j 949-114.31535329954589j 949+107.38715006927039j 949+329.0896534380867j 1013-225.16660498395404j 1013-3.4641016151377544j 1013+218.23840175367852j 1077-114.31535329954589j 1077+107.38715006927039j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'circa'
        if M == 32
            c = [-2.7628962456320787+0.2560200403086832j -2.66880912771588-0.7593416655155307j -2.483838915839059+1.2368048210331923j -2.2142845487197627-1.6721500717544502j -1.869325377035411+2.0505522573050694j -1.756668545833068-0.25257080663450915j -1.6143537075597831+0.7372506352464239j -1.4607085716447898-2.359125345099521j -1.3412535328311816-1.1622028019890276j -1.0023490877736367+2.587361248725592j -0.9594929736144976+1.4930002096006825j -0.5098558079035764-2.7274876682240907j -0.5000000000000001-1.7028436194446255j -0.5-0.5j -0.5+0.5j 0+1.7747327664421122j 0+2.774732766442112j 0.5-0.5j 0.5+0.5j 0.5000000000000001-1.7028436194446255j 0.5098558079035764-2.7274876682240907j 0.9594929736144976+1.4930002096006825j 1.0023490877736367+2.587361248725592j 1.3412535328311816-1.1622028019890276j 1.4607085716447898-2.359125345099521j 1.6143537075597831+0.7372506352464239j 1.756668545833068-0.25257080663450915j 1.869325377035411+2.0505522573050694j 2.2142845487197627-1.6721500717544502j 2.483838915839059+1.2368048210331923j 2.66880912771588-0.7593416655155307j 2.7628962456320787+0.2560200403086832j]';
        elseif M == 64
            c = [-8.599216978862177-0.5008473544539902j -8.482927321041226+1.4957689620885464j -8.251920623528317-2.4704628604784067j -7.909320855619044+3.4117479867195244j -7.459761091450002-4.306895074238955j -6.909320855619045+5.1437987942884025j -6.26544390804443-5.911141459749043j -6.054782792720511-0.5017136063310729j -5.889624101775846+1.4914553796822674j -5.563811818438912-2.440514138209734j -5.536837579881576+6.598546077434501j -5.086233252469906+3.3230020329923824j -4.7333550218064735-7.196716679122122j -4.469915502194058-4.114847094734792j -4+0j -3.8658619570557033+7.697564033576112j -3.731670109218424+4.794449854338647j -3.4641016151377544-2j -3.4641016151377544+2j -2.946089741159648-8.094315039523048j -2.89163448340127-5.343272520114128j -2-3.4641016151377544j -2+3.4641016151377544j -1.986476715483886+8.38160432022745j -1.972722606805445+5.746344640412794j -1.7320508075688772-1j -1.7320508075688772+1j -1-8.555546781007928j -1-5.992671458523495j 0-4j 0-2j 0+2j 0+4j 0+6.075533820974262j 0+8.61379014847791j 1-8.555546781007928j 1-5.992671458523495j 1.7320508075688772-1j 1.7320508075688772+1j 1.972722606805445+5.746344640412794j 1.986476715483886+8.38160432022745j 2-3.4641016151377544j 2+3.4641016151377544j 2.89163448340127-5.343272520114128j 2.946089741159648-8.094315039523048j 3.4641016151377544-2j 3.4641016151377544+2j 3.731670109218424+4.794449854338647j 3.8658619570557033+7.697564033576112j 4+0j 4.469915502194058-4.114847094734792j 4.7333550218064735-7.196716679122122j 5.086233252469906+3.3230020329923824j 5.536837579881576+6.598546077434501j 5.563811818438912-2.440514138209734j 5.889624101775846+1.4914553796822674j 6.054782792720511-0.5017136063310729j 6.26544390804443-5.911141459749043j 6.909320855619045+5.1437987942884025j 7.459761091450002-4.306895074238955j 7.909320855619044+3.4117479867195244j 8.251920623528317-2.4704628604784067j 8.482927321041226+1.4957689620885464j 8.599216978862177-0.5008473544539902j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'circb'
        if M == 32
            c = [-2.85065080835204+0j -2.633657936173204-1.0908968358144764j -2.633657936173204+1.0908968358144764j -2.0157145173806406-2.0157145173806406j -2.0157145173806406+2.0157145173806406j -1.8318138515411297-0.263375070490945j -1.6834111875057185+0.7687881296135142j -1.3986285606904183-1.2119185466338518j -1.0908968358144764-2.633657936173204j -1.0908968358144764+2.633657936173204j -1.0005373658523093+1.556866530563035j -0.8090169943749473+0.2628655560595668j -0.5213885840576788-1.775686447227772j -0.5-0.6881909602355868j 0-2.85065080835204j 0+0.8506508083520399j 0+1.8506508083520399j 0+2.85065080835204j 0.5-0.6881909602355868j 0.5213885840576788-1.775686447227772j 0.8090169943749473+0.2628655560595668j 1.0005373658523093+1.556866530563035j 1.0908968358144764-2.633657936173204j 1.0908968358144764+2.633657936173204j 1.3986285606904183-1.2119185466338518j 1.6834111875057185+0.7687881296135142j 1.8318138515411297-0.263375070490945j 2.0157145173806406-2.0157145173806406j 2.0157145173806406+2.0157145173806406j 2.633657936173204-1.0908968358144764j 2.633657936173204+1.0908968358144764j 2.85065080835204+0j]';
        elseif M == 64
            c = [-8.235740954498494-1j -8.235740954498494+1j -7.75710962592338-2.9418836348521045j -7.75710962592338+2.9418836348521045j -6.827663281835842-4.7127956861585245j -6.827663281835842+4.7127956861585245j -6.157478480644625-0.5102232136459717j -5.989518519041068+1.516752081722304j -5.658180105747559-2.481907906886837j -5.501417965354252-6.209817182500727j -5.501417965354252+6.209817182500727j -5.1725012889439625+3.379363754202542j -4.545730120682499-4.184639367647436j -4.148114905279378+0.5036723384328415j -3.907041544768732-1.4817454097632667j -3.8554502335669385-7.345946675963039j -3.8554502335669385+7.345946675963039j -3.794963284562845+4.8757689276835965j -3.4389051311943066+2.3737048238036715j -2.940679742771269-5.433900221553536j -2.77091205130642-3.1277131415505797j -2.006182123376858+5.843808882500178j -1.9854177481961084-8.055156450048111j -1.9854177481961084+8.055156450048111j -1.9418836348521045+3.699950140285262j -1.7320508075688772-1j -1.7320508075688772+1j -1.0169610853832087-6.094313670805029j -1-4.057159485638117j 0-8.296229810558756j 0-2j 0+2j 0+4.1785814688603775j 0+6.1785814688603775j 0+8.296229810558756j 1-4.057159485638117j 1.0169610853832087-6.094313670805029j 1.7320508075688772-1j 1.7320508075688772+1j 1.9418836348521045+3.699950140285262j 1.9854177481961084-8.055156450048111j 1.9854177481961084+8.055156450048111j 2.006182123376858+5.843808882500178j 2.77091205130642-3.1277131415505797j 2.940679742771269-5.433900221553536j 3.4389051311943066+2.3737048238036715j 3.794963284562845+4.8757689276835965j 3.8554502335669385-7.345946675963039j 3.8554502335669385+7.345946675963039j 3.907041544768732-1.4817454097632667j 4.148114905279378+0.5036723384328415j 4.545730120682499-4.184639367647436j 5.1725012889439625+3.379363754202542j 5.501417965354252-6.209817182500727j 5.501417965354252+6.209817182500727j 5.658180105747559-2.481907906886837j 5.989518519041068+1.516752081722304j 6.157478480644625-0.5102232136459717j 6.827663281835842-4.7127956861585245j 6.827663281835842+4.7127956861585245j 7.75710962592338-2.9418836348521045j 7.75710962592338+2.9418836348521045j 8.235740954498494-1j 8.235740954498494+1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'circular'
        if M == 64
            c = [-7-5j -7-3j -7-1j -7+1j -7+3j -7+5j -5-7j -5-5j -5-3j -5-1j -5+1j -5+3j -5+5j -5+7j -3-7j -3-5j -3-3j -3-1j -3+1j -3+3j -3+5j -3+7j -1-7j -1-5j -1-3j -1-1j -1+1j -1+3j -1+5j -1+7j 0-8.732050807568877j 0+8.732050807568877j 1-7j 1-5j 1-3j 1-1j 1+1j 1+3j 1+5j 1+7j 3-7j 3-5j 3-3j 3-1j 3+1j 3+3j 3+5j 3+7j 5-7j 5-5j 5-3j 5-1j 5+1j 5+3j 5+5j 5+7j 7-5j 7-3j 7-1j 7+1j 7+3j 7+5j -8.732050807568877+0j 8.732050807568877+0j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'compact'
        if M==16
            c = [-4+0.6495190528383289j -3-1.0825317547305482j -3+2.381569860407206j -2-2.814582562299426j -2+0.6495190528383289j -1-1.0825317547305482j -1+2.381569860407206j 0-2.814582562299426j 0+0.6495190528383289j 1-1.0825317547305482j 1+2.381569860407206j 2-2.814582562299426j 2+0.6495190528383289j 3-1.0825317547305482j 3+2.381569860407206j 4+0.6495190528383289j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case {'crossqam', 'cross'}
        if M == 16
            c = [-4-1j -4+1j -2-3j -2-1j -2+1j -2+3j 0-3j 0-1j 0+1j 0+3j 2-3j 2-1j 2+1j 2+3j 4-1j 4+1j]';
        elseif M == 32
            c = [-5-3j -5-1j -5+1j -5+3j -3-5j -3-3j -3-1j -3+1j -3+3j -3+5j -1-5j -1-3j -1-1j -1+1j -1+3j -1+5j +1-5j +1-3j +1-1j +1+1j +1+3j +1+5j +3-5j +3-3j +3-1j +3+1j +3+3j +3+5j +5-3j +5-1j +5+1j +5+3j]';
        elseif M == 64
            c = [-9-2j -9+2j -7-4j -7-2j -7+0j -7+2j -7+4j -5-6j -5-4j -5-2j -5+0j -5+2j -5+4j -5+6j -3-8j -3-6j -3-4j -3-2j -3+0j -3+2j -3+4j -3+6j -3+8j -1-8j -1-6j -1-4j -1-2j -1+0j -1+2j -1+4j -1+6j -1+8j 1-8j 1-6j 1-4j 1-2j 1+0j 1+2j 1+4j 1+6j 1+8j 3-8j 3-6j 3-4j 3-2j 3+0j 3+2j 3+4j 3+6j 3+8j 5-6j 5-4j 5-2j 5+0j 5+2j 5+4j 5+6j 7-4j 7-2j 7+0j 7+2j 7+4j 9-2j 9+2j]';
        elseif M == 128
            c = [-11-7j -11-5j -11-3j -11-1j -11+1j -11+3j -11+5j -11+7j -9-7j -9-5j -9-3j -9-1j -9+1j -9+3j -9+5j -9+7j -7-11j -7-9j -7-7j -7-5j -7-3j -7-1j -7+1j -7+3j -7+5j -7+7j -7+9j -7+11j -5-11j -5-9j -5-7j -5-5j -5-3j -5-1j -5+1j -5+3j -5+5j -5+7j -5+9j -5+11j -3-11j -3-9j -3-7j -3-5j -3-3j -3-1j -3+1j -3+3j -3+5j -3+7j -3+9j -3+11j -1-11j -1-9j -1-7j -1-5j -1-3j -1-1j -1+1j -1+3j -1+5j -1+7j -1+9j -1+11j +1-11j +1-9j +1-7j +1-5j +1-3j +1-1j +1+1j +1+3j +1+5j +1+7j +1+9j +1+11j +3-11j +3-9j +3-7j +3-5j +3-3j +3-1j +3+1j +3+3j +3+5j +3+7j +3+9j +3+11j +5-11j +5-9j +5-7j +5-5j +5-3j +5-1j +5+1j +5+3j +5+5j +5+7j +5+9j +5+11j +7-11j +7-9j +7-7j +7-5j +7-3j +7-1j +7+1j +7+3j +7+5j +7+7j +7+9j +7+11j +9-7j +9-5j +9-3j +9-1j +9+1j +9+3j +9+5j +9+7j +11-7j +11-5j +11-3j +11-1j +11+1j +11+3j +11+5j +11+7j ]';
        elseif M == 512
            c = [-23-15j -23-13j -23-11j -23-9j -23-7j -23-5j -23-3j -23-1j -23+1j -23+3j -23+5j -23+7j -23+9j -23+11j -23+13j -23+15j -21-15j -21-13j -21-11j -21-9j -21-7j -21-5j -21-3j -21-1j -21+1j -21+3j -21+5j -21+7j -21+9j -21+11j -21+13j -21+15j -19-15j -19-13j -19-11j -19-9j -19-7j -19-5j -19-3j -19-1j -19+1j -19+3j -19+5j -19+7j -19+9j -19+11j -19+13j -19+15j -17-15j -17-13j -17-11j -17-9j -17-7j -17-5j -17-3j -17-1j -17+1j -17+3j -17+5j -17+7j -17+9j -17+11j -17+13j -17+15j -15-23j -15-21j -15-19j -15-17j -15-15j -15-13j -15-11j -15-9j -15-7j -15-5j -15-3j -15-1j -15+1j -15+3j -15+5j -15+7j -15+9j -15+11j -15+13j -15+15j -15+17j -15+19j -15+21j -15+23j -13-23j -13-21j -13-19j -13-17j -13-15j -13-13j -13-11j -13-9j -13-7j -13-5j -13-3j -13-1j -13+1j -13+3j -13+5j -13+7j -13+9j -13+11j -13+13j -13+15j -13+17j -13+19j -13+21j -13+23j -11-23j -11-21j -11-19j -11-17j -11-15j -11-13j -11-11j -11-9j -11-7j -11-5j -11-3j -11-1j -11+1j -11+3j -11+5j -11+7j -11+9j -11+11j -11+13j -11+15j -11+17j -11+19j -11+21j -11+23j -9-23j -9-21j -9-19j -9-17j -9-15j -9-13j -9-11j -9-9j -9-7j -9-5j -9-3j -9-1j -9+1j -9+3j -9+5j -9+7j -9+9j -9+11j -9+13j -9+15j -9+17j -9+19j -9+21j -9+23j -7-23j -7-21j -7-19j -7-17j -7-15j -7-13j -7-11j -7-9j -7-7j -7-5j -7-3j -7-1j -7+1j -7+3j -7+5j -7+7j -7+9j -7+11j -7+13j -7+15j -7+17j -7+19j -7+21j -7+23j -5-23j -5-21j -5-19j -5-17j -5-15j -5-13j -5-11j -5-9j -5-7j -5-5j -5-3j -5-1j -5+1j -5+3j -5+5j -5+7j -5+9j -5+11j -5+13j -5+15j -5+17j -5+19j -5+21j -5+23j -3-23j -3-21j -3-19j -3-17j -3-15j -3-13j -3-11j -3-9j -3-7j -3-5j -3-3j -3-1j -3+1j -3+3j -3+5j -3+7j -3+9j -3+11j -3+13j -3+15j -3+17j -3+19j -3+21j -3+23j -1-23j -1-21j -1-19j -1-17j -1-15j -1-13j -1-11j -1-9j -1-7j -1-5j -1-3j -1-1j -1+1j -1+3j -1+5j -1+7j -1+9j -1+11j -1+13j -1+15j -1+17j -1+19j -1+21j -1+23j 1-23j 1-21j 1-19j 1-17j 1-15j 1-13j 1-11j 1-9j 1-7j 1-5j 1-3j 1-1j 1+1j 1+3j 1+5j 1+7j 1+9j 1+11j 1+13j 1+15j 1+17j 1+19j 1+21j 1+23j 3-23j 3-21j 3-19j 3-17j 3-15j 3-13j 3-11j 3-9j 3-7j 3-5j 3-3j 3-1j 3+1j 3+3j 3+5j 3+7j 3+9j 3+11j 3+13j 3+15j 3+17j 3+19j 3+21j 3+23j 5-23j 5-21j 5-19j 5-17j 5-15j 5-13j 5-11j 5-9j 5-7j 5-5j 5-3j 5-1j 5+1j 5+3j 5+5j 5+7j 5+9j 5+11j 5+13j 5+15j 5+17j 5+19j 5+21j 5+23j 7-23j 7-21j 7-19j 7-17j 7-15j 7-13j 7-11j 7-9j 7-7j 7-5j 7-3j 7-1j 7+1j 7+3j 7+5j 7+7j 7+9j 7+11j 7+13j 7+15j 7+17j 7+19j 7+21j 7+23j 9-23j 9-21j 9-19j 9-17j 9-15j 9-13j 9-11j 9-9j 9-7j 9-5j 9-3j 9-1j 9+1j 9+3j 9+5j 9+7j 9+9j 9+11j 9+13j 9+15j 9+17j 9+19j 9+21j 9+23j 11-23j 11-21j 11-19j 11-17j 11-15j 11-13j 11-11j 11-9j 11-7j 11-5j 11-3j 11-1j 11+1j 11+3j 11+5j 11+7j 11+9j 11+11j 11+13j 11+15j 11+17j 11+19j 11+21j 11+23j 13-23j 13-21j 13-19j 13-17j 13-15j 13-13j 13-11j 13-9j 13-7j 13-5j 13-3j 13-1j 13+1j 13+3j 13+5j 13+7j 13+9j 13+11j 13+13j 13+15j 13+17j 13+19j 13+21j 13+23j 15-23j 15-21j 15-19j 15-17j 15-15j 15-13j 15-11j 15-9j 15-7j 15-5j 15-3j 15-1j 15+1j 15+3j 15+5j 15+7j 15+9j 15+11j 15+13j 15+15j 15+17j 15+19j 15+21j 15+23j 17-15j 17-13j 17-11j 17-9j 17-7j 17-5j 17-3j 17-1j 17+1j 17+3j 17+5j 17+7j 17+9j 17+11j 17+13j 17+15j 19-15j 19-13j 19-11j 19-9j 19-7j 19-5j 19-3j 19-1j 19+1j 19+3j 19+5j 19+7j 19+9j 19+11j 19+13j 19+15j 21-15j 21-13j 21-11j 21-9j 21-7j 21-5j 21-3j 21-1j 21+1j 21+3j 21+5j 21+7j 21+9j 21+11j 21+13j 21+15j 23-15j 23-13j 23-11j 23-9j 23-7j 23-5j 23-3j 23-1j 23+1j 23+3j 23+5j 23+7j 23+9j 23+11j 23+13j 23+15j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'dodeca'
        if M==16
            c = [-3.8637033051562737+0j -3.3460652149512318-1.9318516525781368j -3.3460652149512318+1.9318516525781368j -1.9318516525781368-3.3460652149512318j -1.9318516525781368+3.3460652149512318j -1-1j -1+1j 0-3.8637033051562737j 0+3.8637033051562737j 1-1j 1+1j 1.9318516525781368-3.3460652149512318j 1.9318516525781368+3.3460652149512318j 3.3460652149512318-1.9318516525781368j 3.3460652149512318+1.9318516525781368j 3.8637033051562737+0j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'doublesimplex'
        if M == 4
            c = [-1 -sqrt(3)*1j sqrt(3)*1j 1]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'doubleqpsk'
        if M == 8
            c = [-(1+sqrt(2))-(1+sqrt(2))*1j -(1+sqrt(2))+(1+sqrt(2))*1j -1-1j -1+1j 1-1j 1+1j  (1+sqrt(2))-(1+sqrt(2))*1j (1+sqrt(2))+(1+sqrt(2))*1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'dsq'
        if M == 8
            c = [-3+1j -3-3j -1+3j  -1-1j +1+1j  +1-3j +3+3j +3-1j].';
        elseif M == 32
            c = [-7-5j -7-1j -7+3j -7+7j -5-7j -5-3j -5+1j -5+5j -3-5j -3-1j -3+3j -3+7j -1-7j -1-3j -1+1j -1+5j +1-5j +1-1j +1+3j +1+7j +3-7j +3-3j +3+1j +3+5j +5-5j +5-1j +5+3j +5+7j +7-7j +7-3j +7+1j +7+5j]';
        elseif M == 128
            c = [-15-15j -15-11j -15-7j -15-3j -15+1j -15+5j -15+9j -15+13j -13-13j -13-9j -13-5j -13-1j -13+3j -13+7j -13+11j -13+15j -11-15j -11-11j -11-7j -11-3j -11+1j -11+5j -11+9j -11+13j -9-13j -9-9j -9-5j -9-1j -9+3j -9+7j -9+11j -9+15j -7-15j -7-11j -7-7j -7-3j -7+1j -7+5j -7+9j -7+13j -5-13j -5-9j -5-5j -5-1j -5+3j -5+7j -5+11j -5+15j -3-15j -3-11j -3-7j -3-3j -3+1j -3+5j -3+9j -3+13j -1-13j -1-9j -1-5j -1-1j -1+3j -1+7j -1+11j -1+15j +1-15j +1-11j +1-7j +1-3j +1+1j +1+5j +1+9j +1+13j +3-13j +3-9j +3-5j +3-1j +3+3j +3+7j +3+11j +3+15j +5-15j +5-11j +5-7j +5-3j +5+1j +5+5j +5+9j +5+13j +7-13j +7-9j +7-5j +7-1j +7+3j +7+7j +7+11j +7+15j +9-15j +9-11j +9-7j +9-3j +9+1j +9+5j +9+9j +9+13j +11-13j +11-9j +11-5j +11-1j +11+3j +11+7j +11+11j +11+15j +13-15j +13-11j +13-7j +13-3j +13+1j +13+5j +13+9j +13+13j +15-13j +15-9j +15-5j +15-1j +15+3j +15+7j +15+11j +15+15j]';
        elseif M == 512
            c = [-31-31j -31-27j -31-23j -31-19j -31-15j -31-11j -31-7j -31-3j -31+1j -31+5j -31+9j -31+13j -31+17j -31+21j -31+25j -31+29j -29-29j -29-25j -29-21j -29-17j -29-13j -29-9j -29-5j -29-1j -29+3j -29+7j -29+11j -29+15j -29+19j -29+23j -29+27j -29+31j -27-31j -27-27j -27-23j -27-19j -27-15j -27-11j -27-7j -27-3j -27+1j -27+5j -27+9j -27+13j -27+17j -27+21j -27+25j -27+29j -25-29j -25-25j -25-21j -25-17j -25-13j -25-9j -25-5j -25-1j -25+3j -25+7j -25+11j -25+15j -25+19j -25+23j -25+27j -25+31j -23-31j -23-27j -23-23j -23-19j -23-15j -23-11j -23-7j -23-3j -23+1j -23+5j -23+9j -23+13j -23+17j -23+21j -23+25j -23+29j -21-29j -21-25j -21-21j -21-17j -21-13j -21-9j -21-5j -21-1j -21+3j -21+7j -21+11j -21+15j -21+19j -21+23j -21+27j -21+31j -19-31j -19-27j -19-23j -19-19j -19-15j -19-11j -19-7j -19-3j -19+1j -19+5j -19+9j -19+13j -19+17j -19+21j -19+25j -19+29j -17-29j -17-25j -17-21j -17-17j -17-13j -17-9j -17-5j -17-1j -17+3j -17+7j -17+11j -17+15j -17+19j -17+23j -17+27j -17+31j -15-31j -15-27j -15-23j -15-19j -15-15j -15-11j -15-7j -15-3j -15+1j -15+5j -15+9j -15+13j -15+17j -15+21j -15+25j -15+29j -13-29j -13-25j -13-21j -13-17j -13-13j -13-9j -13-5j -13-1j -13+3j -13+7j -13+11j -13+15j -13+19j -13+23j -13+27j -13+31j -11-31j -11-27j -11-23j -11-19j -11-15j -11-11j -11-7j -11-3j -11+1j -11+5j -11+9j -11+13j -11+17j -11+21j -11+25j -11+29j -9-29j -9-25j -9-21j -9-17j -9-13j -9-9j -9-5j -9-1j -9+3j -9+7j -9+11j -9+15j -9+19j -9+23j -9+27j -9+31j -7-31j -7-27j -7-23j -7-19j -7-15j -7-11j -7-7j -7-3j -7+1j -7+5j -7+9j -7+13j -7+17j -7+21j -7+25j -7+29j -5-29j -5-25j -5-21j -5-17j -5-13j -5-9j -5-5j -5-1j -5+3j -5+7j -5+11j -5+15j -5+19j -5+23j -5+27j -5+31j -3-31j -3-27j -3-23j -3-19j -3-15j -3-11j -3-7j -3-3j -3+1j -3+5j -3+9j -3+13j -3+17j -3+21j -3+25j -3+29j -1-29j -1-25j -1-21j -1-17j -1-13j -1-9j -1-5j -1-1j -1+3j -1+7j -1+11j -1+15j -1+19j -1+23j -1+27j -1+31j 1-31j 1-27j 1-23j 1-19j 1-15j 1-11j 1-7j 1-3j 1+1j 1+5j 1+9j 1+13j 1+17j 1+21j 1+25j 1+29j 3-29j 3-25j 3-21j 3-17j 3-13j 3-9j 3-5j 3-1j 3+3j 3+7j 3+11j 3+15j 3+19j 3+23j 3+27j 3+31j 5-31j 5-27j 5-23j 5-19j 5-15j 5-11j 5-7j 5-3j 5+1j 5+5j 5+9j 5+13j 5+17j 5+21j 5+25j 5+29j 7-29j 7-25j 7-21j 7-17j 7-13j 7-9j 7-5j 7-1j 7+3j 7+7j 7+11j 7+15j 7+19j 7+23j 7+27j 7+31j 9-31j 9-27j 9-23j 9-19j 9-15j 9-11j 9-7j 9-3j 9+1j 9+5j 9+9j 9+13j 9+17j 9+21j 9+25j 9+29j 11-29j 11-25j 11-21j 11-17j 11-13j 11-9j 11-5j 11-1j 11+3j 11+7j 11+11j 11+15j 11+19j 11+23j 11+27j 11+31j 13-31j 13-27j 13-23j 13-19j 13-15j 13-11j 13-7j 13-3j 13+1j 13+5j 13+9j 13+13j 13+17j 13+21j 13+25j 13+29j 15-29j 15-25j 15-21j 15-17j 15-13j 15-9j 15-5j 15-1j 15+3j 15+7j 15+11j 15+15j 15+19j 15+23j 15+27j 15+31j 17-31j 17-27j 17-23j 17-19j 17-15j 17-11j 17-7j 17-3j 17+1j 17+5j 17+9j 17+13j 17+17j 17+21j 17+25j 17+29j 19-29j 19-25j 19-21j 19-17j 19-13j 19-9j 19-5j 19-1j 19+3j 19+7j 19+11j 19+15j 19+19j 19+23j 19+27j 19+31j 21-31j 21-27j 21-23j 21-19j 21-15j 21-11j 21-7j 21-3j 21+1j 21+5j 21+9j 21+13j 21+17j 21+21j 21+25j 21+29j 23-29j 23-25j 23-21j 23-17j 23-13j 23-9j 23-5j 23-1j 23+3j 23+7j 23+11j 23+15j 23+19j 23+23j 23+27j 23+31j 25-31j 25-27j 25-23j 25-19j 25-15j 25-11j 25-7j 25-3j 25+1j 25+5j 25+9j 25+13j 25+17j 25+21j 25+25j 25+29j 27-29j 27-25j 27-21j 27-17j 27-13j 27-9j 27-5j 27-1j 27+3j 27+7j 27+11j 27+15j 27+19j 27+23j 27+27j 27+31j 29-31j 29-27j 29-23j 29-19j 29-15j 29-11j 29-7j 29-3j 29+1j 29+5j 29+9j 29+13j 29+17j 29+21j 29+25j 29+29j 31-29j 31-25j 31-21j 31-17j 31-13j 31-9j 31-5j 31-1j 31+3j 31+7j 31+11j 31+15j 31+19j 31+23j 31+27j 31+31j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'ennea'
        if M==16
            c = [-3.6636277030822595-0.52675014098189j -3.366822375011437+1.5375762592270283j -2.7972571213808366-2.4238370932677036j -2.0010747317046187+3.11373306112607j -1.6180339887498947+0.5257311121191336j -1.0427771681153577-3.551372894455544j -1-1.3763819204711736j 0+1.7013016167040798j 0+3.7013016167040798j 1-1.3763819204711736j 1.0427771681153577-3.551372894455544j 1.6180339887498947+0.5257311121191336j 2.0010747317046187+3.11373306112607j 2.7972571213808366-2.4238370932677036j 3.366822375011437+1.5375762592270283j 3.6636277030822595-0.52675014098189j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'fivecircle'
        if M == 128
            c = [-14.017542045684108+0j -13.874863679285642-1.9949042292205084j -13.874863679285642+1.9949042292205084j -13.449733100179689-3.9491979611628283j -13.449733100179689+3.9491979611628283j -12.750804740981494-5.823097411162353j -12.750804740981494+5.823097411162353j -11.792306767541378-7.578455390296865j -11.792306767541378+7.578455390296865j -10.837951447459425+0j -10.653414728532821-1.9914683525900698j -10.653414728532821+1.9914683525900698j -10.593751434518685-9.179537872145586j -10.593751434518685+9.179537872145586j -10.106088748388654-3.915119638935708j -10.106088748388654+3.915119638935708j -9.214612036835579-5.705446221645833j -9.214612036835579+5.705446221645833j -9.179537872145586-10.593751434518685j -9.179537872145586+10.593751434518685j -8.009342764077065-7.301480676206313j -8.009342764077065+7.301480676206313j -7.978729755559481+0j -7.728063288430872-1.9842294026289569j -7.728063288430872+1.9842294026289569j -7.578455390296865-11.792306767541378j -7.578455390296865+11.792306767541378j -6.991814183061516-3.843782374405461j -6.991814183061516+3.843782374405461j -6.531324929635745-8.648871963499428j -6.531324929635745+8.648871963499428j -5.823097411162353-12.750804740981494j -5.823097411162353+12.750804740981494j -5.816243678476569-5.461816363155356j -5.816243678476569+5.461816363155356j -5.442191151751808+0j -5.074692116118667-1.9659461993678038j -5.074692116118667+1.9659461993678038j -4.830890658176517-9.701736289254141j -4.830890658176517+9.701736289254141j -4.27521719292499-6.736664342652737j -4.27521719292499+6.736664342652737j -4.021827790363955-3.6663804708270327j -4.021827790363955+3.6663804708270327j -3.9491979611628283-13.449733100179689j -3.9491979611628283+13.449733100179689j -2.9659461993678042-10.424219621628446j -2.9659461993678042+10.424219621628446j -2.613125929752753+0j -2.46556308799295-7.588222925782882j -2.46556308799295+7.588222925782882j -2.425793335803476-4.871649743585546j -2.425793335803476+4.871649743585546j -1.9949042292205084-13.874863679285642j -1.9949042292205084+13.874863679285642j -1.8477590650225735-1.8477590650225735j -1.8477590650225735+1.8477590650225735j -1-10.791718657261587j -1+10.791718657261587j -0.5021420494578372-5.418975723729711j -0.5021420494578372+5.418975723729711j -0.5009885865355713-7.962985554954332j -0.5009885865355713+7.962985554954332j 0-14.017542045684108j 0-2.613125929752753j 0+2.613125929752753j 0+14.017542045684108j 1-10.791718657261587j 1+10.791718657261587j 1.4893263031322321-5.234439004803107j 1.4893263031322321+5.234439004803107j 1.4950648703209728-7.837404515895705j 1.4950648703209728+7.837404515895705j 1.8477590650225735-1.8477590650225735j 1.8477590650225735+1.8477590650225735j 1.9949042292205084-13.874863679285642j 1.9949042292205084+13.874863679285642j 2.613125929752753+0j 2.9659461993678042-10.424219621628446j 2.9659461993678042+10.424219621628446j 3.279652885842357-4.3429622932500305j 3.279652885842357+4.3429622932500305j 3.397177902911282-7.219370527145809j 3.397177902911282+7.219370527145809j 3.9491979611628283-13.449733100179689j 3.9491979611628283+13.449733100179689j 4.627044173135472-2.864944458808712j 4.627044173135472+2.864944458808712j 4.830890658176517-9.701736289254141j 4.830890658176517+9.701736289254141j 5.085833753915312-6.147716937187816j 5.085833753915312+6.147716937187816j 5.349527505509778-1j 5.349527505509778+1j 5.823097411162353-12.750804740981494j 5.823097411162353+12.750804740981494j 6.454927965772691-4.689779682344992j 6.454927965772691+4.689779682344992j 6.531324929635745-8.648871963499428j 6.531324929635745+8.648871963499428j 7.418435313976122-2.9371663222572635j 7.418435313976122+2.9371663222572635j 7.578455390296865-11.792306767541378j 7.578455390296865+11.792306767541378j 7.915815088305831-1j 7.915815088305831+1j 8.009342764077065-7.301480676206313j 8.009342764077065+7.301480676206313j 9.179537872145586-10.593751434518685j 9.179537872145586+10.593751434518685j 9.214612036835579-5.705446221645833j 9.214612036835579+5.705446221645833j 10.106088748388654-3.915119638935708j 10.106088748388654+3.915119638935708j 10.593751434518685-9.179537872145586j 10.593751434518685+9.179537872145586j 10.653414728532821-1.9914683525900698j 10.653414728532821+1.9914683525900698j 10.837951447459425+0j 11.792306767541378-7.578455390296865j 11.792306767541378+7.578455390296865j 12.750804740981494-5.823097411162353j 12.750804740981494+5.823097411162353j 13.449733100179689-3.9491979611628283j 13.449733100179689+3.9491979611628283j 13.874863679285642-1.9949042292205084j 13.874863679285642+1.9949042292205084j 14.017542045684108+0j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'hepta'
        if M == 8
            c = [constref('psk', 7); 0];
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'hex'
        if M==16
            c = [0+0j 1+0j 0.5+0.8660254037844386j -0.5+0.8660254037844386j -1+0j -0.5-0.8660254037844386j 0.5-0.8660254037844386j 2+0j -1+1.7320508075688772j -1-1.7320508075688772j 1.4999999999999998+0.8660254037844386j 0+1.7320508075688772j -1.4999999999999998+0.8660254037844386j -1.4999999999999998-0.8660254037844386j 0-1.7320508075688772j 1.4999999999999998-0.8660254037844386j].';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'honeycomb'
        if M==16
            c = [-10+0j -8-3.4641016151377544j -8+3.4641016151377544j -4-3.4641016151377544j -4+3.4641016151377544j -2-6.928203230275509j -2+0j -2+6.928203230275509j 2-6.928203230275509j 2+0j 2+6.928203230275509j 4-3.4641016151377544j 4+3.4641016151377544j 8-3.4641016151377544j 8+3.4641016151377544j 10+0j]';
        elseif M == 32
            c = [-6.928203230275509-1j -6.928203230275509+1j -5.196152422706632-4j -5.196152422706632-2j -5.196152422706632+2j -5.196152422706632+4j -3.4641016151377544-5j -3.4641016151377544-1j -3.4641016151377544+1j -3.4641016151377544+5j -1.7320508075688772-4j -1.7320508075688772-2j -1.7320508075688772+2j -1.7320508075688772+4j 0-5j 0-1j 0+1j 0+5j 1.7320508075688772-4j 1.7320508075688772-2j 1.7320508075688772+2j 1.7320508075688772+4j 3.4641016151377544-5j 3.4641016151377544-1j 3.4641016151377544+1j 3.4641016151377544+5j 5.196152422706632-4j 5.196152422706632-2j 5.196152422706632+2j 5.196152422706632+4j 6.928203230275509-1j 6.928203230275509+1j]';
        elseif M == 64
            c = [-10.392304845413264-2j -10.392304845413264+2j -8.660254037844386-5j -8.660254037844386-1j -8.660254037844386+1j -8.660254037844386+5j -6.928203230275509-4j -6.928203230275509-2j -6.928203230275509+2j -6.928203230275509+4j -5.196152422706632-7j -5.196152422706632-5j -5.196152422706632-1j -5.196152422706632+1j -5.196152422706632+5j -5.196152422706632+7j -3.4641016151377544-8j -3.4641016151377544-4j -3.4641016151377544-2j -3.4641016151377544+2j -3.4641016151377544+4j -3.4641016151377544+8j -1.7320508075688772-7j -1.7320508075688772-5j -1.7320508075688772-1j -1.7320508075688772+1j -1.7320508075688772+5j -1.7320508075688772+7j 0-10j 0-8j 0-4j 0-2j 0+2j 0+4j 0+8j 0+10j 1.7320508075688772-7j 1.7320508075688772-5j 1.7320508075688772-1j 1.7320508075688772+1j 1.7320508075688772+5j 1.7320508075688772+7j 3.4641016151377544-8j 3.4641016151377544-4j 3.4641016151377544-2j 3.4641016151377544+2j 3.4641016151377544+4j 3.4641016151377544+8j 5.196152422706632-7j 5.196152422706632-5j 5.196152422706632-1j 5.196152422706632+1j 5.196152422706632+5j 5.196152422706632+7j 6.928203230275509-4j 6.928203230275509-2j 6.928203230275509+2j 6.928203230275509+4j 8.660254037844386-5j 8.660254037844386-1j 8.660254037844386+1j 8.660254037844386+5j 10.392304845413264-2j 10.392304845413264+2j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'modem'
        if M == 8
            c = [-2-sqrt(3)*1j -2+sqrt(3)*1j -1+0j 0-sqrt(3)*1j 0+sqrt(3)*1j 1+0j 2-sqrt(3)*1j 2+sqrt(3)*1j]';
        elseif M == 64
            c = [-8+5.551115123125783e-17j -7-5.196152422706632j -7-1.7320508075688772j -7+1.7320508075688772j -6-3.4641016151377544j -6+5.551115123125783e-17j -6+3.4641016151377544j -5-5.196152422706632j -5-1.7320508075688772j -5+1.7320508075688772j -5+5.196152422706632j -4-6.928203230275509j -4-3.4641016151377544j -4+5.551115123125783e-17j -4+3.4641016151377544j -4+6.928203230275509j -3-5.196152422706632j -3-1.7320508075688772j -3+1.7320508075688772j -3+5.196152422706632j -2-6.928203230275509j -2-3.4641016151377544j -2+5.551115123125783e-17j -2+3.4641016151377544j -2+6.928203230275509j -1-5.196152422706632j -1-1.7320508075688772j -1+1.7320508075688772j -1+5.196152422706632j -1+8.660254037844386j 0-6.928203230275509j 0-3.4641016151377544j 0+5.551115123125783e-17j 0+3.4641016151377544j 0+6.928203230275509j 1-5.196152422706632j 1-1.7320508075688772j 1+1.7320508075688772j 1+5.196152422706632j 2-6.928203230275509j 2-3.4641016151377544j 2+5.551115123125783e-17j 2+3.4641016151377544j 2+6.928203230275509j 3-5.196152422706632j 3-1.7320508075688772j 3+1.7320508075688772j 3+5.196152422706632j 4-6.928203230275509j 4-3.4641016151377544j 4+5.551115123125783e-17j 4+3.4641016151377544j 4+6.928203230275509j 5-5.196152422706632j 5-1.7320508075688772j 5+1.7320508075688772j 5+5.196152422706632j 6-3.4641016151377544j 6+5.551115123125783e-17j 6+3.4641016151377544j 7-1.7320508075688772j 7+1.7320508075688772j 8-3.4641016151377544j 8+5.551115123125783e-17j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'multipsk'
        if M == 16
            c = [2.414213562373095+1j 1+2.414213562373095j -1+2.414213562373095j -2.414213562373095+1j -2.414213562373095-1j -1-2.414213562373095j 1-2.414213562373095j 2.414213562373095-1j 4.261972627395669+1.7653668647301797j 1.7653668647301797+4.261972627395669j -1.7653668647301797+4.261972627395669j -4.261972627395669+1.7653668647301797j -4.261972627395669-1.7653668647301797j -1.7653668647301797-4.261972627395669j 1.7653668647301797-4.261972627395669j 4.261972627395669-1.7653668647301797j].';
        elseif M == 32
            c = [2.414213562373095+1j 1+2.414213562373095j -1+2.414213562373095j -2.414213562373095+1j -2.414213562373095-1j -1-2.414213562373095j 1-2.414213562373095j 2.414213562373095-1j 4.261972627395669+1.7653668647301797j 1.7653668647301797+4.261972627395669j -1.7653668647301797+4.261972627395669j -4.261972627395669+1.7653668647301797j -4.261972627395669-1.7653668647301797j -1.7653668647301797-4.261972627395669j 1.7653668647301797-4.261972627395669j 4.261972627395669-1.7653668647301797j 6.109731692418242+2.5307337294603593j 2.5307337294603593+6.109731692418242j -2.5307337294603593+6.109731692418242j -6.109731692418242+2.5307337294603593j -6.109731692418242-2.5307337294603593j -2.5307337294603593-6.109731692418242j 2.5307337294603593-6.109731692418242j 6.109731692418242-2.5307337294603593j 7.957490757440816+3.2961005941905386j 3.2961005941905386+7.957490757440816j -3.2961005941905386+7.957490757440816j -7.957490757440816+3.2961005941905386j -7.957490757440816-3.2961005941905386j -3.2961005941905386-7.957490757440816j 3.2961005941905386-7.957490757440816j 7.957490757440816-3.2961005941905386j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'octa'
        if M==16
            c = [2.414213562373095+1j 1+2.414213562373095j -1+2.414213562373095j -2.414213562373095+1j -2.414213562373095-1j -1-2.414213562373095j 1-2.414213562373095j 2.414213562373095-1j 4.146264369941973+0j 2.9318516525781364+2.9318516525781364j 0+4.146264369941973j -2.9318516525781364+2.9318516525781364j -4.146264369941973+0j -2.9318516525781364-2.9318516525781364j 0-4.146264369941973j 2.9318516525781364-2.9318516525781364j];
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'penta'
        if M==16
            c = [0+0j 0.8090169943749475+0.5877852522924731j -0.30901699437494745+0.9510565162951535j -1+0j -0.30901699437494745-0.9510565162951535j 0.8090169943749475-0.5877852522924731j 1.8090169943749475+0.5877852522924732j 1.118033988749895+1.5388417685876268j 0+1.9021130325903073j -1.118033988749895+1.5388417685876268j -1.8090169943749475+0.5877852522924732j -1.8090169943749475-0.5877852522924732j -1.118033988749895-1.5388417685876268j 0-1.9021130325903073j 1.118033988749895-1.5388417685876268j 1.8090169943749475-0.5877852522924732j].';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'psk'
        if ~mod(M,1)
            c = exp(2j*pi*(0:M-1)/M);
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'rectangle'
        if M == 8
            c = [-3-1j -3+1j -1-1j -1+1j 1-1j 1+1j 3-1j 3+1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'star'
        if M==8
            c = [-(1+sqrt(3))/2-1j*(1+sqrt(3))/2 -(1+sqrt(3))/2+1j*(1+sqrt(3))/2 -1 -1j +1j +1 (1+sqrt(3))/2-1j*(1+sqrt(3))/2 (1+sqrt(3))/2+1j*(1+sqrt(3))/2].';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'square'
        if M == 8
            c = [-1-1j -1+0j -1+1j 0-1j 0+1j 1-1j 1+0j 1+1j ]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'sixcircle'
        if M == 128
            c = [-12.109565585441024+0j -11.944406894496359-1.9931689860133408j -11.944406894496359+1.9931689860133408j -11.45343592021476-3.931969517892002j -11.45343592021476+3.931969517892002j -10.65004507090882-5.763516171202118j -10.65004507090882+5.763516171202118j -10+0j -9.781476007338057-2.079116908177593j -9.781476007338057+2.079116908177593j -9.556148754663967-7.437849127727176j -9.556148754663967+7.437849127727176j -9.135454576426008-4.0673664307580015j -9.135454576426008+4.0673664307580015j -8.201585611412483-8.909296949073441j -8.201585611412483+8.909296949073441j -8.090169943749475-5.877852522924732j -8.090169943749475+5.877852522924732j -8+0j -7.727406610312546-2.0705523608201655j -7.727406610312546+2.0705523608201655j -6.928203230275509-4j -6.928203230275509+4j -6.691306063588582-7.431448254773942j -6.691306063588582+7.431448254773942j -6.623304592619695-10.137722374452776j -6.623304592619695+10.137722374452776j -6+0j -5.65685424949238-5.65685424949238j -5.65685424949238+5.65685424949238j -5.638155724715451-2.0521208599540124j -5.638155724715451+2.0521208599540124j -5-8.660254037844386j -5+8.660254037844386j -4.864357090206716-11.089617160526924j -4.864357090206716+11.089617160526924j -4.596266658713869-3.8567256581192355j -4.596266658713869+3.8567256581192355j -4-6.928203230275509j -4+0j -4+6.928203230275509j -3.4641016151377544-2j -3.4641016151377544+2j -3.0901699437494745-9.510565162951535j -3.0901699437494745+9.510565162951535j -3-5.196152422706632j -3+5.196152422706632j -2.972722606805446-11.739016098936291j -2.972722606805446+11.739016098936291j -2.0705523608201655-7.727406610312546j -2.0705523608201655+7.727406610312546j -2-3.4641016151377544j -2+0j -2+3.4641016151377544j -1.0452846326765346-9.945218953682733j -1.0452846326765346+9.945218953682733j -1.041889066001582-5.908846518073248j -1.041889066001582+5.908846518073248j -1-12.068205279497759j -1+12.068205279497759j -1-1.7320508075688772j -1+1.7320508075688772j 0-8j 0-4j 0+4j 0+8j 1-1.7320508075688772j 1+1.7320508075688772j 1-12.068205279497759j 1+12.068205279497759j 1.041889066001582-5.908846518073248j 1.041889066001582+5.908846518073248j 1.0452846326765346-9.945218953682733j 1.0452846326765346+9.945218953682733j 2-3.4641016151377544j 2+0j 2+3.4641016151377544j 2.0705523608201655-7.727406610312546j 2.0705523608201655+7.727406610312546j 2.972722606805446-11.739016098936291j 2.972722606805446+11.739016098936291j 3-5.196152422706632j 3+5.196152422706632j 3.0901699437494745-9.510565162951535j 3.0901699437494745+9.510565162951535j 3.4641016151377544-2j 3.4641016151377544+2j 4-6.928203230275509j 4+0j 4+6.928203230275509j 4.596266658713869-3.8567256581192355j 4.596266658713869+3.8567256581192355j 4.864357090206716-11.089617160526924j 4.864357090206716+11.089617160526924j 5-8.660254037844386j 5+8.660254037844386j 5.638155724715451-2.0521208599540124j 5.638155724715451+2.0521208599540124j 5.65685424949238-5.65685424949238j 5.65685424949238+5.65685424949238j 6+0j 6.623304592619695-10.137722374452776j 6.623304592619695+10.137722374452776j 6.691306063588582-7.431448254773942j 6.691306063588582+7.431448254773942j 6.928203230275509-4j 6.928203230275509+4j 7.727406610312546-2.0705523608201655j 7.727406610312546+2.0705523608201655j 8+0j 8.090169943749475-5.877852522924732j 8.090169943749475+5.877852522924732j 8.201585611412483-8.909296949073441j 8.201585611412483+8.909296949073441j 9.135454576426008-4.0673664307580015j 9.135454576426008+4.0673664307580015j 9.556148754663967-7.437849127727176j 9.556148754663967+7.437849127727176j 9.781476007338057-2.079116908177593j 9.781476007338057+2.079116908177593j 10+0j 10.65004507090882-5.763516171202118j 10.65004507090882+5.763516171202118j 11.45343592021476-3.931969517892002j 11.45343592021476+3.931969517892002j 11.944406894496359-1.9931689860133408j 11.944406894496359+1.9931689860133408j 12.109565585441024+0j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 't'
        if M==16
            c = [-3-1.7320508075688772j -3+1.7320508075688772j -2-3.4641016151377544j -2+0j -2+3.4641016151377544j -1-1.7320508075688772j -1+1.7320508075688772j 0-3.4641016151377544j 0+3.4641016151377544j 1-1.7320508075688772j 1+1.7320508075688772j 2-3.4641016151377544j 2+0j 2+3.4641016151377544j 3-1.7320508075688772j 3+1.7320508075688772j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'ta'
        if M == 32
            c = [-5.105317901528887-1j -5.105317901528887+1j -4.738675539522665-3.32446197714957j -4.738675539522665+3.32446197714957j -3.32446197714957-4.738675539522665j -3.32446197714957-1.910248414776475j -3.32446197714957+1.910248414776475j -3.32446197714957+4.738675539522665j -2.732050807568877+0j -1.910248414776475-3.32446197714957j -1.910248414776475+3.32446197714957j -1-5.105317901528887j -1-1j -1+1j -1+5.105317901528887j 0-2.732050807568877j 0+2.732050807568877j 1-5.105317901528887j 1-1j 1+1j 1+5.105317901528887j 1.910248414776475-3.32446197714957j 1.910248414776475+3.32446197714957j 2.732050807568877+0j 3.32446197714957-4.738675539522665j 3.32446197714957-1.910248414776475j 3.32446197714957+1.910248414776475j 3.32446197714957+4.738675539522665j 4.738675539522665-3.32446197714957j 4.738675539522665+3.32446197714957j 5.105317901528887-1j 5.105317901528887+1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'tb'
        if M == 32
            c = [-5.7320508075688785-1j -5.7320508075688785+1j -4.732050807568878-2.7320508075688776j -4.732050807568878+2.7320508075688776j -3.732050807568878-1j -3.732050807568878+1j -2.7320508075688776-4.732050807568878j -2.7320508075688776-2.7320508075688776j -2.7320508075688776+2.7320508075688776j -2.7320508075688776+4.732050807568878j -1-5.7320508075688785j -1-3.732050807568878j -1-1j -1+1j -1+3.732050807568878j -1+5.7320508075688785j 1-5.7320508075688785j 1-3.732050807568878j 1-1j 1+1j 1+3.732050807568878j 1+5.7320508075688785j 2.7320508075688776-4.732050807568878j 2.7320508075688776-2.7320508075688776j 2.7320508075688776+2.7320508075688776j 2.7320508075688776+4.732050807568878j 3.732050807568878-1j 3.732050807568878+1j 4.732050807568878-2.7320508075688776j 4.732050807568878+2.7320508075688776j 5.7320508075688785-1j 5.7320508075688785+1j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'tri'
        if M == 4
            c = [-0.8660254037844386-0.5j 1j 0 0.8660254037844386-0.5j].';
        elseif M == 16
            c = [-4+1.1547005383792517j -3-0.5773502691896255j -3+2.886751345948129j -2-2.309401076758503j -2+1.1547005383792517j -1-0.5773502691896255j -1+2.886751345948129j 0-2.309401076758503j 0+1.1547005383792517j 1-0.5773502691896255j 1+2.886751345948129j 2-2.309401076758503j 2+1.1547005383792517j 3-0.5773502691896255j 3+2.886751345948129j 4+1.1547005383792517j]';
        elseif M == 32
            c = [-3+0j -2.5-0.8660254037844386j -2.5+0.8660254037844386j -2-1.7320508075688772j -2+0j -2+1.7320508075688772j -1.4999999999999998-0.8660254037844386j -1.4999999999999998+0.8660254037844386j -1-1.7320508075688772j -1+0j -1+1.7320508075688772j -0.5-2.598076211353316j -0.5-0.8660254037844386j -0.5+0.8660254037844386j -0.5+2.598076211353316j 0-1.7320508075688772j 0+1.7320508075688772j 0.5-2.598076211353316j 0.5-0.8660254037844386j 0.5+0.8660254037844386j 0.5+2.598076211353316j 1-1.7320508075688772j 1+0j 1+1.7320508075688772j 1.4999999999999998-0.8660254037844386j 1.4999999999999998+0.8660254037844386j 2-1.7320508075688772j 2+0j 2+1.7320508075688772j 2.5-0.8660254037844386j 2.5+0.8660254037844386j 3+0j]';
        elseif M == 64
            c = [-8+0j -7-1.7320508075688772j -7+1.7320508075688772j -6-3.4641016151377544j -6+0j -6+3.4641016151377544j -5-5.196152422706632j -5-1.7320508075688772j -5+1.7320508075688772j -5+5.196152422706632j -4-6.928203230275509j -4-3.4641016151377544j -4+0j -4+3.4641016151377544j -4+6.928203230275509j -3-5.196152422706632j -3-1.7320508075688772j -3+1.7320508075688772j -3+5.196152422706632j -2-6.928203230275509j -2-3.4641016151377544j -2+0j -2+3.4641016151377544j -2+6.928203230275509j -1-8.660254037844386j -1-5.196152422706632j -1-1.7320508075688772j -1+1.7320508075688772j -1+5.196152422706632j -1+8.660254037844386j 0-6.928203230275509j 0-3.4641016151377544j 0+3.4641016151377544j 0+6.928203230275509j 1-8.660254037844386j 1-5.196152422706632j 1-1.7320508075688772j 1+1.7320508075688772j 1+5.196152422706632j 1+8.660254037844386j 2-6.928203230275509j 2-3.4641016151377544j 2+0j 2+3.4641016151377544j 2+6.928203230275509j 3-5.196152422706632j 3-1.7320508075688772j 3+1.7320508075688772j 3+5.196152422706632j 4-6.928203230275509j 4-3.4641016151377544j 4+0j 4+3.4641016151377544j 4+6.928203230275509j 5-5.196152422706632j 5-1.7320508075688772j 5+1.7320508075688772j 5+5.196152422706632j 6-3.4641016151377544j 6+0j 6+3.4641016151377544j 7-1.7320508075688772j 7+1.7320508075688772j 8+0j]';
        elseif M == 128
            c = [-12+0j -11-1.7320508075688772j -11+1.7320508075688772j -10-3.4641016151377544j -10+0j -10+3.4641016151377544j -9-5.196152422706632j -9-1.7320508075688772j -9+1.7320508075688772j -9+5.196152422706632j -8-6.928203230275509j -8-3.4641016151377544j -8+0j -8+3.4641016151377544j -8+6.928203230275509j -7-8.660254037844386j -7-5.196152422706632j -7-1.7320508075688772j -7+1.7320508075688772j -7+5.196152422706632j -7+8.660254037844386j -6-10.392304845413264j -6-6.928203230275509j -6-3.4641016151377544j -6+0j -6+3.4641016151377544j -6+6.928203230275509j -6+10.392304845413264j -5-8.660254037844386j -5-5.196152422706632j -5-1.7320508075688772j -5+1.7320508075688772j -5+5.196152422706632j -5+8.660254037844386j -4-10.392304845413264j -4-6.928203230275509j -4-3.4641016151377544j -4+0j -4+3.4641016151377544j -4+6.928203230275509j -4+10.392304845413264j -3-8.660254037844386j -3-5.196152422706632j -3-1.7320508075688772j -3+1.7320508075688772j -3+5.196152422706632j -3+8.660254037844386j -2-10.392304845413264j -2-6.928203230275509j -2-3.4641016151377544j -2+0j -2+3.4641016151377544j -2+6.928203230275509j -2+10.392304845413264j -1-8.660254037844386j -1-5.196152422706632j -1-1.7320508075688772j -1+1.7320508075688772j -1+5.196152422706632j -1+8.660254037844386j 0-12.392304845413264j 0-10.392304845413264j 0-6.928203230275509j 0-3.4641016151377544j 0+3.4641016151377544j 0+6.928203230275509j 0+10.392304845413264j 0+12.392304845413264j 1-8.660254037844386j 1-5.196152422706632j 1-1.7320508075688772j 1+1.7320508075688772j 1+5.196152422706632j 1+8.660254037844386j 2-10.392304845413264j 2-6.928203230275509j 2-3.4641016151377544j 2+0j 2+3.4641016151377544j 2+6.928203230275509j 2+10.392304845413264j 3-8.660254037844386j 3-5.196152422706632j 3-1.7320508075688772j 3+1.7320508075688772j 3+5.196152422706632j 3+8.660254037844386j 4-10.392304845413264j 4-6.928203230275509j 4-3.4641016151377544j 4+0j 4+3.4641016151377544j 4+6.928203230275509j 4+10.392304845413264j 5-8.660254037844386j 5-5.196152422706632j 5-1.7320508075688772j 5+1.7320508075688772j 5+5.196152422706632j 5+8.660254037844386j 6-10.392304845413264j 6-6.928203230275509j 6-3.4641016151377544j 6+0j 6+3.4641016151377544j 6+6.928203230275509j 6+10.392304845413264j 7-8.660254037844386j 7-5.196152422706632j 7-1.7320508075688772j 7+1.7320508075688772j 7+5.196152422706632j 7+8.660254037844386j 8-6.928203230275509j 8-3.4641016151377544j 8+0j 8+3.4641016151377544j 8+6.928203230275509j 9-5.196152422706632j 9-1.7320508075688772j 9+1.7320508075688772j 9+5.196152422706632j 10-3.4641016151377544j 10+0j 10+3.4641016151377544j 11-1.7320508075688772j 11+1.7320508075688772j 12+0j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'v29modem'
        if M == 8
            c = [-3+0j -1-1j -1+1j 0-3j 0+3j 1-1j 1+1j 3+0j]';
        elseif M == 16
            c = [-5+0j -3-3j -3+0j -3+3j -1-1j -1+1j 0-5j 0-3j 0+3j 0+5j 1-1j 1+1j 3-3j 3+0j 3+3j 5+0j];
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    case 'voronoi'
        if M == 64
            c = [-7.25-3.4641016151377544j -7.25+0j -7.25+3.4641016151377544j -6.25-5.196152422706632j -6.25-1.7320508075688772j -6.25+1.7320508075688772j -6.25+5.196152422706632j -5.25-3.4641016151377544j -5.25+0j -5.25+3.4641016151377544j -4.25-5.196152422706632j -4.25-1.7320508075688772j -4.25+1.7320508075688772j -4.25+5.196152422706632j -3.25-6.928203230275509j -3.25-3.4641016151377544j -3.25+0j -3.25+3.4641016151377544j -3.25+6.928203230275509j -2.25-5.196152422706632j -2.25-1.7320508075688772j -2.25+1.7320508075688772j -2.25+5.196152422706632j -1.25-6.928203230275509j -1.25-3.4641016151377544j -1.25+0j -1.25+3.4641016151377544j -1.25+6.928203230275509j -0.25-8.660254037844386j -0.25-5.196152422706632j -0.25-1.7320508075688772j -0.25+1.7320508075688772j -0.25+5.196152422706632j -0.25+8.660254037844386j 0.75-6.928203230275509j 0.75-3.4641016151377544j 0.75+0j 0.75+3.4641016151377544j 0.75+6.928203230275509j 1.75-5.196152422706632j 1.75-1.7320508075688772j 1.75+1.7320508075688772j 1.75+5.196152422706632j 2.75-6.928203230275509j 2.75-3.4641016151377544j 2.75+0j 2.75+3.4641016151377544j 2.75+6.928203230275509j 3.75-5.196152422706632j 3.75-1.7320508075688772j 3.75+1.7320508075688772j 3.75+5.196152422706632j 4.75-3.4641016151377544j 4.75+0j 4.75+3.4641016151377544j 5.75-5.196152422706632j 5.75-1.7320508075688772j 5.75+1.7320508075688772j 5.75+5.196152422706632j 6.75-3.4641016151377544j 6.75+0j 6.75+3.4641016151377544j 7.75-1.7320508075688772j 7.75+1.7320508075688772j]';
        else
            robolog(['Constellation order, M = ' num2str(M) ', is not supported by ' upper(type) '.'], 'ERR');
        end
    otherwise
        robolog(['Constellation type ' upper(type) ' not supported.'], 'ERR');
end

rot = defaultargs(0,varargin);
c = c(:).*exp(1j*deg2rad(rot));
P = pwr.meanpwr(c);
